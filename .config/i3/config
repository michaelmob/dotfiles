# vim: filetype=i3

#
# Mike Mob's i3-gaps configuration
#
# Website: https://mikemob.com
# E-mail: mike@mikemob.com
# GitHub: https://github.com/thetarkus
#

#
# definitions
#

# modifier key
set $mod Mod4
set $alt Mod1

# terminal
set $terminal st


#
# autostart programs
#

# mouse & keyboard
exec --no-startup-id touchpad disable
exec --no-startup-id setxkbmap -option caps:escape
exec --no-startup-id xset r rate 250 30
exec --no-startup-id alttab

# scratchpads
exec --no-startup-id $terminal -c dropdown -e bash -c 'source ~/.bashrc; while true; do tmux a -t scratch || tmux new -s scratch; done'
exec --no-startup-id $terminal -c math -e bash -c 'source ~/.bashrc; while true; do math; done'

# power manager
exec --no-startup-id run-hypersomnia

# compositor
exec --no-startup-id compton

# flux
exec --no-startup-id redshift -m vidmode -l 40.7:-74

# set wallpaper, colorize i3
exec --no-startup-id set-colors

# sync tool
exec --no-startup-id syncthing-gtk --minimized

# drive mounting tool
exec --no-startup-id udiskie -s

# network manager
exec --no-startup-id nm-applet

# cursor
exec --no-startup-id unclutter

#
# application launchers
#

# terminal
bindsym $mod+Return          exec $terminal

# file manager
bindsym $mod+r               exec $terminal -e ~/.scripts/ranger

# process viewer
bindsym $mod+g               exec $terminal -e ~/.scripts/htop

# launcher
bindsym $mod+d               exec rofi -show run

# ssh
bindsym $mod+Shift+Tab       exec rofi -show ssh

# screenshot
bindsym Ctrl+Shift+4         exec flameshot gui

# change wallpaper
bindsym $mod+Shift+bar       exec set-colors

# firefox private browsing
bindsym Ctrl+$mod+p          exec firefox --private-window about:blank

# edit common configurations
bindsym $mod+F1              exec $terminal -e ~/.scripts/ranger ~/.config/i3
bindsym $mod+F2              exec $terminal -e ~/.scripts/ranger ~/.config/ranger

# xf86 keys
bindsym XF86AudioRaiseVolume exec pamixer -i 5 && pkill -RTMIN+10 i3blocks 
bindsym XF86AudioLowerVolume exec pamixer -d 5 && pkill -RTMIN+10 i3blocks
bindsym XF86AudioMute        exec pamixer -t && pkill -RTMIN+10 i3blocks
bindsym XF86AudioMicMute     exec pamixer --source 1 -t
bindsym XF86TouchpadToggle   exec touchpad toggle

# music
bindsym Pause                exec playerctl play-pause
bindsym XF86AudioPlay        exec playerctl play-pause
bindsym XF86AudioStop        exec playerctl stop
bindsym XF86AudioPrev        exec playerctl previous
bindsym XF86AudioNext        exec playerctl next



#
# mouse
#

# key to hold while dragging mouse
floating_modifier $mod

# do not focus window on mouseover
focus_follows_mouse no


#
# windows
#

# window settings
new_window pixel 3

# window rules
for_window [instance="float"]                       floating enable
for_window [class="Clock-applet"]                   floating enable
for_window [class="Xfce4-panel"]                    floating enable
for_window [class="Wrapper-1.0"]                    floating enable
for_window [class="lxqt-notificationd"]             floating enable
for_window [class="Syncthing GTK"]                  floating enable
for_window [class="qt5ct"]                          floating enable
for_window [class="Xscreensaver-demo"]              floating enable
for_window [class="net-runelite-launcher-Launcher"] floating enable
for_window [class="Lxappearance"]                   floating enable
for_window [class="Wpg"]                            floating enable
for_window [class="tridactyl_editor"]               floating enable
for_window [class="Arandr"]                         floating enable

no_focus [floating]


#
# scratchpads
#

# dropdown
for_window [class="dropdown"] floating enable
for_window [class="dropdown"] resize set 800 300
for_window [class="dropdown"] move scratchpad
for_window [class="dropdown"] border pixel 5
bindsym $mod+apostrophe [class="dropdown"] scratchpad show, [class="dropdown"] move position center

# calculator
for_window [class="math"] floating enable
for_window [class="math"] resize set 800 300
for_window [class="math"] move scratchpad
for_window [class="math"] border pixel 5
bindsym $mod+c [class="math"] scratchpad show, [class="math"] move position center 


#
# colors
#

# color variables
set_from_resource $darkblack   color0  #000000
set_from_resource $darkred     color1  #000000
set_from_resource $darkgreen   color2  #000000
set_from_resource $darkyellow  color3  #000000
set_from_resource $darkblue    color4  #000000
set_from_resource $darkmagenta color5  #000000
set_from_resource $darkcyan    color6  #000000
set_from_resource $darkwhite   color7  #000000
set_from_resource $black       color8  #000000
set_from_resource $red         color9  #000000
set_from_resource $green       color10 #000000
set_from_resource $yellow      color11 #000000
set_from_resource $blue        color12 #000000
set_from_resource $magenta     color13 #000000
set_from_resource $cyan        color14 #000000
set               $white       #FFFFFFFF
set               $transparent #00000000

# state                 border   bg         text       indicator    child_border
client.focused          $darkred $darkred   $white     $darkmagenta $darkred
client.unfocused        $darkred $darkblack $darkwhite $darkblue    $darkblack
client.focused_inactive $darkred $darkred   $white     $darkmagenta $darkblack
client.urgent           $darkred $darkred   $darkwhite $darkred     $darkred
client.background       $black


#
# i3-gaps management
#

# gaps
gaps inner 10
smart_gaps on

# resize gaps
bindsym $mod+Shift+minus        gaps inner current minus 5
bindsym $mod+Shift+plus         gaps inner current plus 5
bindsym $mod+Shift+bracketleft  gaps outer current minus 5
bindsym $mod+Shift+bracketright gaps outer current plus 5
bindsym $mod+Shift+apostrophe   gaps inner current set 0; gaps outer current set 0


#
# i3 window management
#

# font
font pango:Hack 10

# kill focused window
bindsym $mod+Shift+q [con_id="__focused__" class="^(?!dropdown|math).*$"] kill

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# splits
bindsym $mod+bar   split h
bindsym $mod+minus split v
bindsym $mod+t     split toggle

# fullscreen
bindsym $mod+f fullscreen toggle

# sticky
bindsym $mod+z sticky toggle

# layouts
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# focus the parent container
bindsym $mod+a focus parent

# resize window
bindsym $mod+Shift+y resize shrink width 30 px or 10 ppt
bindsym $mod+Shift+u resize grow height 30 px or 10 ppt
bindsym $mod+Shift+i resize shrink height 30 px or 10 ppt
bindsym $mod+Shift+o resize grow width 30 px or 10 ppt

# workspaces
set $ws1  "1"
set $ws2  "2"
set $ws3  "3"
set $ws4  "4"
set $ws5  "5"
set $ws6  "6"
set $ws7  "7"
set $ws8  "8"
set $ws9  "9"
set $ws10 "10"

# switch workspaces
bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $ws8
bindsym $mod+9 workspace $ws9
bindsym $mod+0 workspace $ws10

# switch to last used workspace
bindsym $mod+Tab workspace back_and_forth

# move window to workspace
bindsym $mod+Shift+1 move container to workspace $ws1
bindsym $mod+Shift+2 move container to workspace $ws2
bindsym $mod+Shift+3 move container to workspace $ws3
bindsym $mod+Shift+4 move container to workspace $ws4
bindsym $mod+Shift+5 move container to workspace $ws5
bindsym $mod+Shift+6 move container to workspace $ws6
bindsym $mod+Shift+7 move container to workspace $ws7
bindsym $mod+Shift+8 move container to workspace $ws8
bindsym $mod+Shift+9 move container to workspace $ws9
bindsym $mod+Shift+0 move container to workspace $ws10

# wm actions
bindsym $mod+Shift+c reload
bindsym $mod+Shift+r restart
bindsym $mod+Shift+BackSpace exec "i3-nagbar -t warning -m 'Do you want to exit i3?' -b 'Yes, exit i3' 'i3-msg exit'"

#
# i3bar and i3blocks
#

# Desktop bar with more modules
bar {
  position       top
  mode           dock
  status_command SCRIPT_DIR=~/.scripts/i3blocks-contrib i3blocks -c ~/.config/i3blocks/config-large
  output         HDMI-A-0
  output         DP1
  output         DP2

  colors {
    background $darkblack
    statusline $darkwhite
    separator  $cyan

    focused_workspace  $red       $darkred   $white
    active_workspace   $blue      $blue      $white
    inactive_workspace $darkblack $darkblack $darkwhite
    urgent_workspace   $darkblack $darkblack $darkwhite
  }
}

# Laptop bar with fewer modules
bar {
  position       top
  mode           dock
  status_command SCRIPT_DIR=~/.scripts/i3blocks-contrib i3blocks -c ~/.config/i3blocks/config-small
  output LVDS1

  colors {
    background $darkblack
    statusline $darkwhite
    separator  $cyan

    focused_workspace  $red       $darkred   $white
    active_workspace   $blue      $blue      $white
    inactive_workspace $darkblack $darkblack $darkwhite
    urgent_workspace   $darkblack $darkblack $darkwhite
  }
}
