#!/usr/bin/env bash
#
# Launch a scratchpad of any window by title.
# $1 -> Window title
# $2 -> Run command
#

get_window_id() {
  #
  # Get window ID(s) of scratchpad.
  #   $1 -> window title
  #
  xdotool search --name "$1"
}


is_visible() {
  #
  # Test if window is visible.
  #   $1 -> window title
  #
  xdotool search --onlyvisible --name "$1"
}


WINDOW_ID="$(get_window_id "$1")"

# Window is visible
if [[ "$(is_visible "$1")" ]]; then
  xdotool windowminimize "$WINDOW_ID"

# Window is not visible
else
  # Window exists
  if [[ "$WINDOW_ID" ]]; then
    xdotool set_desktop_for_window "$WINDOW_ID" "$(xdotool get_desktop)" && \
      exec xdotool windowactivate "$WINDOW_ID"

  # Window does not exist
  else
    exec $2 & disown
  fi
fi

exit 1
